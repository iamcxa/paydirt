# Paydirt + Goldflow è¨­è¨ˆæ–‡ä»¶

> **Date**: 2026-01-09
> **Status**: Approved
> **Migration**: Gas Town â†’ Paydirt

---

## 1. æ¶æ§‹ç¸½è¦½

### æ ¸å¿ƒåŸå‰‡ï¼šæ„ç¾©èˆ‡æ©Ÿåˆ¶åˆ†é›¢

é€™ä¸æ˜¯å–®ç´”çš„æ”¹åï¼Œè€Œæ˜¯æ¶æ§‹é‡æ§‹ã€‚Gas Town æ··åˆäº†å…©å€‹é—œæ³¨é»ï¼š
- äººé¡å°å‘çš„æ„ç¾©ï¼ˆè§’è‰²ã€æ‰€æœ‰æ¬Šã€æ„åœ–ï¼‰
- æ©Ÿå™¨å°å‘çš„åŸ·è¡Œï¼ˆç®¡ç·šã€é‡è©¦ã€é©—è­‰ã€æŒ‡æ¨™ï¼‰

æ–°æ¶æ§‹æ˜ç¢ºåˆ†é›¢é€™å…©å±¤ï¼š

| å±¤æ¬¡ | åç¨± | è§’è‰² | é—œæ³¨é» |
|------|------|------|--------|
| èªæ„å±¤ | **Paydirt** (Town) | äººé¡æ„åœ–ã€è§’è‰²ã€æ•˜äº‹ | **ä»€éº¼**å’Œ**ç‚ºä»€éº¼** |
| åŸ·è¡Œå±¤ | **Goldflow** (River) | ç®¡ç·šã€é©—è­‰ã€æŒ‡æ¨™ | **å¦‚ä½•**å¯é åŸ·è¡Œ |

### æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        PAYDIRT (Town)                           â”‚
â”‚         èªæ„å±¤ - äººé¡æ„åœ–ã€è§’è‰²ã€æ•˜äº‹                              â”‚
â”‚                                                                 â”‚
â”‚   Chief Prospector (Human)                                      â”‚
â”‚         â”‚                                                       â”‚
â”‚         â”œâ”€â”€ Boomtown (Dashboard/HQ)                             â”‚
â”‚         â”‚      â””â”€â”€ Camp Boss (Commander)                        â”‚
â”‚         â”‚                                                       â”‚
â”‚         â””â”€â”€ Claims (Projects)                                   â”‚
â”‚                â””â”€â”€ Caravans (Work Teams)                        â”‚
â”‚                       â””â”€â”€ Prospects (Agents)                    â”‚
â”‚                              â””â”€â”€ Tunnels (State) + Ledger       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ decides WHAT & WHY
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       GOLDFLOW (River)                          â”‚
â”‚         åŸ·è¡Œå±¤ - ç®¡ç·šã€é©—è­‰ã€æŒ‡æ¨™                                  â”‚
â”‚                                                                 â”‚
â”‚   Sources â†’ Stages â†’ Processors â†’ Verifiers â†’ Sinks             â”‚
â”‚                          â”‚                                      â”‚
â”‚                    Controllers + Metrics                        â”‚
â”‚                                                                 â”‚
â”‚         decides HOW to execute reliably                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é—œéµè¦å‰‡

```
æè¿°ç³»çµ±æ™‚ â†’ ä½¿ç”¨ Paydirt è¡“èª
å¯¦ä½œç®¡ç·šæ™‚ â†’ ä½¿ç”¨ Goldflow è¡“èª
æ°¸ä¸æ··ç”¨å…©å±¤æ¦‚å¿µ
```

---

## 2. Paydirt å±¤ï¼ˆèªæ„å±¤ï¼‰

### æ ¸å¿ƒæ¦‚å¿µ

| æ¦‚å¿µ | èªªæ˜ | å°æ‡‰ Gas Town |
|------|------|---------------|
| **Chief Prospector** | äººé¡æ“æœ‰è€…/æ±ºç­–è€… | Human/User |
| **Claim** | å°ˆæ¡ˆ/ä»£ç¢¼åº«ï¼Œä½ å®£ç¤ºã€æ¢ç´¢ã€æŠ•è³‡çš„é ˜åœ° | Project/Repo |
| **Caravan** | æ¢å‹˜éšŠä¼ï¼Œä¸€çµ„ Prospects å”ä½œå®Œæˆä»»å‹™ | Convoy |
| **Prospect** | Agent å·¥äººï¼Œæœ‰ç›®çš„çš„è§’è‰² | Agent |
| **Tunnel** | æŒä¹…ç‹€æ…‹å’Œè¨˜æ†¶ï¼Œè·¨ session ä¿å­˜ | State/Context |
| **Ledger** | æ­·å²ã€æˆæœ¬ã€çµæœè¨˜éŒ„ | History/Metrics |
| **Boomtown** | æ§åˆ¶ä¸­å¿ƒ/Dashboard | Dashboard |

### Prospect è§’è‰²é«”ç³»

**æŒ‡æ®å±¤**
- **Camp Boss** - ç‡Ÿåœ°ç®¡ç†è€…ï¼Œäººé¡çš„ä¸»è¦ä»‹é¢ï¼Œç›£æ§å…¨å±€
- **Claim Agent** - ç¤¦æ¬Šä»£ç†äººï¼Œä»£è¡¨ Chief Prospector åšæ±ºç­–

**å”èª¿å±¤**
- **Trail Boss** - è»ŠéšŠé ˜éšŠï¼Œå”èª¿ Caravanï¼Œèˆ‡ç”¨æˆ¶äº’å‹•
- **Shift Boss** - ç­é•·ï¼Œå°‡è¨­è¨ˆåˆ†è§£ç‚ºå¯åŸ·è¡Œä»»å‹™

**å°ˆæ¥­å±¤**
- **Surveyor** - æ¸¬é‡å“¡ï¼Œå‹˜æ¸¬åœ°å½¢ã€è¨­è¨ˆæ–¹æ¡ˆ
- **Miner** - ç¤¦å·¥ï¼Œå¯¦éš›æŒ–æ˜ï¼ˆå¯«ç¨‹å¼ç¢¼ï¼‰
- **Assayer** - åŒ–é©—å“¡ï¼Œé©—è­‰å“è³ªï¼ˆç¨‹å¼ç¢¼å¯©æŸ¥ï¼‰
- **Canary** - é‡‘çµ²é›€ï¼Œå®‰å…¨åµæ¸¬ï¼ˆæ¸¬è©¦ï¼‰
- **Smelter** - å†¶ç…‰å·¥ï¼Œæç´”ç”¢å‡ºï¼ˆç¨‹å¼ç¢¼å“è³ªï¼‰
- **Scout** - åµå¯Ÿå…µï¼Œæ¢ç´¢å¤–éƒ¨è³‡æºï¼ˆLinearã€GitHubï¼‰

### è§’è‰²æ˜ å°„è¡¨

| Gas Town | Paydirt | æé‡‘éš±å–» | è·è²¬ |
|----------|---------|----------|------|
| Commander | **Camp Boss** | ç‡Ÿåœ°ç®¡ç†è€… | æˆ°ç•¥ç›£æ§ã€äººé¡ä»‹é¢ |
| Mayor | **Trail Boss** | è»ŠéšŠé ˜éšŠ | Caravan å”èª¿ã€ç”¨æˆ¶äº’å‹• |
| Planner | **Surveyor** | æ¸¬é‡å“¡ | å‹˜æ¸¬åœ°å½¢ã€è¨­è¨ˆæ–¹æ¡ˆ |
| Foreman | **Shift Boss** | ç­é•· | ä»»å‹™åˆ†è§£ã€å·¥ä½œæ’ç¨‹ |
| Polecat | **Miner** | ç¤¦å·¥ | æŒ–æ˜ï¼ˆå¯¦ä½œç¨‹å¼ç¢¼ï¼‰ |
| Witness | **Assayer** | åŒ–é©—å“¡ | é©—é‡‘ï¼ˆç¨‹å¼ç¢¼å¯©æŸ¥ï¼‰ |
| Dog | **Canary** | é‡‘çµ²é›€ | å®‰å…¨åµæ¸¬ï¼ˆæ¸¬è©¦ï¼‰ |
| Refinery | **Smelter** | å†¶ç…‰å·¥ | æç´”ï¼ˆç¨‹å¼ç¢¼å“è³ªï¼‰ |
| PM/Prime | **Claim Agent** | ç¤¦æ¬Šä»£ç†äºº | ä»£è¡¨ç¤¦ä¸»æ±ºç­– |
| Linear-Scout | **Scout** | åµå¯Ÿå…µ | æ¢ç´¢æ–°é ˜åŸŸï¼ˆå¤–éƒ¨è³‡æ–™ï¼‰ |

---

## 3. Goldflow å±¤ï¼ˆåŸ·è¡Œå±¤ï¼‰

### æ ¸å¿ƒåŸå‰‡

Goldflow æ˜¯ä¸€å€‹**ç¢ºå®šæ€§çš„åƒ¹å€¼æµç³»çµ±**ï¼š
- ç„¡è§’è‰²ã€ç„¡è§’è‰²å€‹æ€§
- å°‡è¼¸å…¥ï¼ˆpromptsã€specsã€issuesï¼‰è½‰æ›ç‚ºè¼¸å‡ºï¼ˆcodeã€PRsã€artifactsï¼‰
- è² è²¬è¦åŠƒã€åŸ·è¡Œã€é©—è­‰ã€é‡è©¦ã€æ¸¬é‡
- å¯ç¨ç«‹æ–¼ Paydirt æ¼”é€²ï¼ˆæ–°æ¨¡å‹ã€ç®¡ç·šã€åŸºç¤è¨­æ–½ï¼‰

### Goldflow çµ„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚ Sources â”‚â”€â”€â”€â–¶â”‚ Stages  â”‚â”€â”€â”€â–¶â”‚ Processors â”‚â”€â”€â”€â–¶â”‚ Verifiers â”‚â”€â”€â”€â–¶â”‚ Sinks â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚                 â”‚
                              â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
                              â”‚        Controllers          â”‚
                              â”‚        + Metrics            â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| çµ„ä»¶ | è·è²¬ | ç¯„ä¾‹ |
|------|------|------|
| **Sources** | è¼¸å…¥ä¾†æº | Linear issuesã€GitHub PRsã€ç”¨æˆ¶è¼¸å…¥ |
| **Stages** | å·¥ä½œæµéšæ®µ | Planningã€Implementationã€Review |
| **Processors** | è™•ç†å™¨ï¼ˆLLMã€å·¥å…·ï¼‰ | Claude åŸ·è¡Œå¯¦ä½œã€æ¸¬è©¦ |
| **Verifiers** | é©—è­‰é–˜é–€ | æ¸¬è©¦é€šéã€è¦å‰‡æª¢æŸ¥ã€äººé¡å¯©æ ¸ |
| **Sinks** | è¼¸å‡ºç›®çš„åœ° | PRsã€Commitsã€Artifacts |
| **Controllers** | æµç¨‹ç·¨æ’ | é‡è©¦é‚è¼¯ã€ä¸¦è¡Œæ§åˆ¶ã€ç‹€æ…‹æ©Ÿ |
| **Metrics** | æ¸¬é‡è¨˜éŒ„ | æˆæœ¬ã€æ™‚é–“ã€æˆåŠŸç‡ |

### Paydirt â†’ Goldflow æ˜ å°„

| Paydirt è§’è‰² | Goldflow çµ„ä»¶ | èªªæ˜ |
|-------------|---------------|------|
| Camp Boss | **Controller** | å…¨å±€æ§åˆ¶ |
| Trail Boss | **Controller** | Caravan æµç¨‹æ§åˆ¶ |
| Surveyor | **Stage** | è¦åŠƒéšæ®µ |
| Shift Boss | **Controller** | ä»»å‹™åˆ†é…æ§åˆ¶ |
| Miner | **Processor** | æ ¸å¿ƒè™•ç†å™¨ï¼ˆLLM åŸ·è¡Œï¼‰ |
| Assayer | **Verifier** | å“è³ªé©—è­‰é–˜é–€ |
| Canary | **Verifier** | å®‰å…¨é©—è­‰é–˜é–€ |
| Smelter | **Verifier** | å“è³ªæ”¹å–„è™•ç† |
| Claim Agent | **Controller** | æ±ºç­–è·¯ç”±æ§åˆ¶ |
| Scout | **Source** | å¤–éƒ¨è¼¸å…¥æº |

---

## 4. Goldflow Ã— Superpowers æ•´åˆ

### æ ¸å¿ƒç†å¿µ

**Goldflow çš„ Processor/Verifier ç”± Superpowers é©…å‹•ï¼š**
- æ¯å€‹ Prospect è§’è‰²ç¶å®šç‰¹å®šçš„ Superpowers
- Superpowers å®šç¾©ã€Œå¦‚ä½•å¯é åŸ·è¡Œã€
- Paydirt æ±ºå®šã€Œæ´¾èª°å»ã€ï¼ŒGoldflow (Superpowers) æ±ºå®šã€Œæ€éº¼åšã€

### Prospect Ã— Superpowers æ˜ å°„

| Prospect | Goldflow çµ„ä»¶ | Superpowers |
|----------|---------------|-------------|
| **Trail Boss** | Controller | `dispatching-parallel-agents`, `finishing-a-development-branch` |
| **Surveyor** | Stage | `brainstorming`, `writing-plans` |
| **Shift Boss** | Controller | `subagent-driven-development`, `writing-plans` |
| **Miner** | Processor | `executing-plans`, `test-driven-development` |
| **Assayer** | Verifier | `requesting-code-review`, `receiving-code-review` |
| **Canary** | Verifier | `test-driven-development`, `verification-before-completion` |
| **Smelter** | Verifier | `systematic-debugging` |
| **Claim Agent** | Controller | (æ±ºç­–è·¯ç”±ï¼Œç„¡ç‰¹å®š skill) |
| **Scout** | Source | (å¤–éƒ¨è³‡æ–™ç²å–ï¼Œç„¡ç‰¹å®š skill) |
| **Camp Boss** | Controller | `dispatching-parallel-agents` |

### Goldflow åŸ·è¡Œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         GOLDFLOW                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Source â”€â”€â–¶ Stage â”€â”€â–¶ Processor â”€â”€â–¶ Verifier â”€â”€â–¶ Sink          â”‚
â”‚    â”‚         â”‚           â”‚            â”‚                        â”‚
â”‚    â”‚         â”‚           â”‚            â”‚                        â”‚
â”‚  Scout    Surveyor     Miner      Assayer/                     â”‚
â”‚           uses:        uses:      Canary/Smelter               â”‚
â”‚           â€¢ brainstorming         uses:                        â”‚
â”‚           â€¢ writing-plans   â€¢ executing-plans                  â”‚
â”‚                            â€¢ TDD     â€¢ code-review             â”‚
â”‚                                      â€¢ verification            â”‚
â”‚                                      â€¢ debugging               â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Controller: Trail Boss / Shift Boss                      â”‚   â”‚
â”‚  â”‚ uses: dispatching-parallel-agents, subagent-driven-dev   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Goldflow é…ç½®ç¯„ä¾‹

```yaml
# goldflow.yaml
processors:
  miner:
    superpowers:
      - executing-plans
      - test-driven-development
    retry_policy: 3
    timeout: 30m

verifiers:
  assayer:
    superpowers:
      - requesting-code-review
    gates:
      - tests_pass
      - no_security_issues

  canary:
    superpowers:
      - verification-before-completion
    gates:
      - all_tests_pass
      - coverage_threshold: 80%

controllers:
  trail-boss:
    superpowers:
      - dispatching-parallel-agents
      - finishing-a-development-branch
    max_parallel: 3
```

---

## 5. BD è¨˜éŒ„æ¨¡å¼

### ä¸‰ç¨®è¨˜éŒ„æ¨¡å¼

| æ¨¡å¼ | è§’è‰² | è¨˜éŒ„ä½ç½® | èªªæ˜ |
|------|------|----------|------|
| **Caravan æ¨¡å¼** | Trail Boss, Miner, Assayer, Canary, Smelter, Surveyor, Shift Boss | `$PAYDIRT_CLAIM` (Caravan) | å·¥äººè¨˜éŒ„åˆ°æ‰€å±¬ Caravan |
| **Agent æ¨¡å¼** | Claim Agent | Caravan + **Decision Ledger** | é›™å¯«ï¼šå›ç­”åˆ° Caravanï¼Œæ±ºç­–è¨˜éŒ„åˆ°ç¨ç«‹å¸³ç°¿ |
| **Journal æ¨¡å¼** | Camp Boss | **Commander Journal** | ç¨ç«‹æ—¥èªŒï¼Œç›£æ§æ‰€æœ‰ Caravan |

### æ¨¡å¼ä¸€ï¼šCaravan è¨˜éŒ„ï¼ˆä¸€èˆ¬ Prospectï¼‰

```bash
# è®€å–ä»»å‹™
bd show $PAYDIRT_CLAIM

# æ›´æ–°ç‹€æ…‹
bd agent state $PAYDIRT_CLAIM working
bd agent state $PAYDIRT_CLAIM done
bd agent heartbeat $PAYDIRT_CLAIM

# è¨˜éŒ„é€²åº¦ï¼ˆå„è§’è‰²æœ‰ä¸åŒå‰ç¶´ï¼‰
bd comments add $PAYDIRT_CLAIM "PROGRESS: 3/5 steps done"
bd comments add $PAYDIRT_CLAIM "REVIEW: approved"
bd comments add $PAYDIRT_CLAIM "TEST-RESULT: pass"
bd comments add $PAYDIRT_CLAIM "AUDIT: pass"
bd comments add $PAYDIRT_CLAIM "OUTPUT: design=docs/plans/..."
bd comments add $PAYDIRT_CLAIM "TASKS: [task list]"
bd comments add $PAYDIRT_CLAIM "CHECKPOINT: context=85%"

# æ›´æ–°ç‹€æ…‹
bd update $PAYDIRT_CLAIM --status "done"
```

**Comment å‰ç¶´å°ç…§ï¼š**

| Prospect | å‰ç¶´ |
|----------|------|
| Miner | `PROGRESS:`, `CHECKPOINT:` |
| Assayer | `REVIEW:` |
| Canary | `TEST-RESULT:` |
| Smelter | `AUDIT:` |
| Surveyor | `OUTPUT:` |
| Shift Boss | `TASKS:` |
| Trail Boss | `PROGRESS:`, `DECISION:`, `QUESTION:` |

### æ¨¡å¼äºŒï¼šAgent è¨˜éŒ„ï¼ˆClaim Agentï¼‰

```bash
# 1. è®€å– Caravan ä¸­çš„å•é¡Œ
bd show $PAYDIRT_CLAIM
bd comments $PAYDIRT_CLAIM  # æ‰¾ QUESTION: å‰ç¶´

# 2. å›ç­”å¯«å› Caravan
bd comments add $PAYDIRT_CLAIM "ANSWER [high]: Use Supabase Auth.
Reasoning: Context file specifies 'Use Supabase ecosystem'."

# 3. åŒæ™‚è¨˜éŒ„åˆ° Decision Ledgerï¼ˆæ°¸ä¹…æ±ºç­–è¨˜éŒ„ï¼‰
LEDGER=$(bd list --label paydirt:ledger --type epic --limit 1 --brief | head -1)
bd comments add $LEDGER "DECISION caravan=$PAYDIRT_CARAVAN
Q: Which auth provider?
A: Supabase Auth
Confidence: high
Source: context
Reasoning: Context file specifies..."

# 4. è¨˜éŒ„åˆ° Caravan çš„ DECISION-LOG
bd comments add $PAYDIRT_CLAIM "DECISION-LOG: q=auth provider, a=Supabase, source=context, confidence=high"
```

### æ¨¡å¼ä¸‰ï¼šJournal è¨˜éŒ„ï¼ˆCamp Bossï¼‰

```bash
# 1. æ‰¾åˆ° Commander Journal
JOURNAL=$(bd list --label paydirt:camp-boss --limit 1 --brief | head -1)

# 2. è¨˜éŒ„è§€å¯Ÿ
bd comments add $JOURNAL "[timestamp] OBSERVATION: caravan-abc completed planning"

# 3. è¨˜éŒ„æ±ºç­–
bd comments add $JOURNAL "[timestamp] DECISION: Approved auth design. Reason: ..."

# 4. æ›´æ–°ç›®æ¨™
bd comments add $JOURNAL "[timestamp] GOAL_UPDATE: Added P0 task from Linear"

# 5. è¨˜éŒ„å¤–éƒ¨åŒæ­¥
bd comments add $JOURNAL "LINEAR_SYNC: P0=2 P1=5 P2+=10 (timestamp)"
```

### BD Label è¨­è¨ˆ

| Label | ç”¨é€” |
|-------|------|
| `paydirt:caravan` | æ¨™è¨˜ Caravanï¼ˆå·¥ä½œåœ˜éšŠï¼‰ |
| `paydirt:prospect` | æ¨™è¨˜ Prospect agent bead |
| `paydirt:camp-boss` | Camp Boss Journal |
| `paydirt:ledger` | Decision Ledger |
| `paydirt:tunnel` | æŒä¹…ç‹€æ…‹è¨˜éŒ„ |
| `paydirt:mode:prime` | Prime æ¨¡å¼æ¨™è¨˜ |
| `paydirt:backlog` | å¾…è¾¦ä½‡åˆ— |

### BD è¨˜éŒ„é »ç‡è¦ç¯„

æ¯å€‹ Prospect å¿…é ˆéµå¾ªä»¥ä¸‹è¨˜éŒ„è¦å‰‡ï¼Œç¢ºä¿å·¥ä½œé€²åº¦å¯è¿½è¹¤ã€å¯æ¢å¾©ã€‚

#### é€šç”¨è¦å‰‡ï¼ˆæ‰€æœ‰ Prospectï¼‰

| äº‹ä»¶ | å¿…é ˆåŸ·è¡Œçš„ bd å‘½ä»¤ | èªªæ˜ |
|------|-------------------|------|
| **é–‹å§‹å·¥ä½œ** | `bd agent state $PAYDIRT_CLAIM working` | å®£å‘Šé–‹å§‹è™•ç†ä»»å‹™ |
| **æ¯å®Œæˆä¸€å€‹æ­¥é©Ÿ** | `bd comments add $PAYDIRT_CLAIM "PROGRESS: X/Y steps"` | è¨˜éŒ„é€²åº¦æ¯”ä¾‹ |
| **æ¯ 5 åˆ†é˜ï¼ˆé•·ä»»å‹™ï¼‰** | `bd agent heartbeat $PAYDIRT_CLAIM` | è­‰æ˜ä»åœ¨é‹ä½œ |
| **Context > 70%** | `bd comments add $PAYDIRT_CLAIM "CHECKPOINT: context=X%..."` | æº–å‚™ respawn |
| **Context > 85%** | `bd agent state $PAYDIRT_CLAIM stuck` | è§¸ç™¼ respawn æµç¨‹ |
| **å®Œæˆå·¥ä½œ** | `bd agent state $PAYDIRT_CLAIM done` | æ¨™è¨˜å®Œæˆ |
| **é‡åˆ°é˜»å¡** | `bd agent state $PAYDIRT_CLAIM blocked` + `QUESTION:` comment | ç­‰å¾…å›ç­” |
| **ç”¢å‡ºäº¤ä»˜ç‰©** | `bd comments add $PAYDIRT_CLAIM "OUTPUT: ..."` | è¨˜éŒ„ç”¢å‡ºä½ç½® |

#### å„è§’è‰²ç‰¹å®šè¨˜éŒ„è¦å‰‡

##### Camp Bossï¼ˆJournal æ¨¡å¼ï¼‰

| æ™‚æ©Ÿ | è¨˜éŒ„å…§å®¹ | ç¯„ä¾‹ |
|------|----------|------|
| æ”¶åˆ° Scout å ±å‘Š | `DISCOVERY:` | `bd comments add $JOURNAL "DISCOVERY: [Linear] LIN-456..."` |
| æ”¶åˆ°ç”¨æˆ¶è«‹æ±‚ | `REQUEST:` | `bd comments add $JOURNAL "REQUEST: User wants..."` |
| åšå‡ºé€²ä»¶æ±ºç­– | `INTAKE_DECISION:` | `bd comments add $JOURNAL "INTAKE_DECISION: task â†’ STAKE"` |
| Caravan ç‹€æ…‹è®Šæ›´ | `OBSERVATION:` | `bd comments add $JOURNAL "OBSERVATION: caravan completed"` |
| æ¯ 10 åˆ†é˜ | `LINEAR_SYNC:` | `bd comments add $JOURNAL "LINEAR_SYNC: P0=2 P1=5..."` |

##### Trail Bossï¼ˆCaravan æ¨¡å¼ï¼‰

| æ™‚æ©Ÿ | è¨˜éŒ„å…§å®¹ | ç¯„ä¾‹ |
|------|----------|------|
| é–‹å§‹ Caravan | `bd update --status in_progress` | æ¨™è¨˜ Caravan é–‹å§‹ |
| å§”æ´¾å‰ | `DECISION:` | `"DECISION: Spawning Surveyor for design"` |
| éœ€è¦æ±ºç­–æ™‚ | `QUESTION:` | `"QUESTION [decision]: Which auth provider?"` |
| æ”¶åˆ° Prospect å®Œæˆ | `PROGRESS:` | `"PROGRESS: Design complete, starting breakdown"` |
| æ¯æ¬¡å§”æ´¾å¾Œ | Heartbeat | `bd agent heartbeat $PAYDIRT_CLAIM` |
| æ‰€æœ‰ä»»å‹™å®Œæˆ | `bd update --status ready-for-review` | é€²å…¥äº¤ä»˜æµç¨‹ |

##### Surveyorï¼ˆCaravan æ¨¡å¼ï¼‰

| æ™‚æ©Ÿ | è¨˜éŒ„å…§å®¹ | ç¯„ä¾‹ |
|------|----------|------|
| é–‹å§‹è¨­è¨ˆ | State + Progress | `bd agent state ... working` + `"PROGRESS: Starting brainstorm"` |
| brainstorming å®Œæˆ | `PROGRESS:` | `"PROGRESS: Brainstorm done, writing plan"` |
| è¨­è¨ˆæ–‡æª”å®Œæˆ | `OUTPUT:` | `"OUTPUT: design=docs/plans/YYYY-MM-DD-feature.md"` |
| å®Œæˆ | State | `bd agent state ... done` |

##### Shift Bossï¼ˆCaravan æ¨¡å¼ï¼‰

| æ™‚æ©Ÿ | è¨˜éŒ„å…§å®¹ | ç¯„ä¾‹ |
|------|----------|------|
| é–‹å§‹åˆ†è§£ | State | `bd agent state ... working` |
| æ¯å‰µå»º 3 å€‹ä»»å‹™ | `TASKS:` | `"TASKS: created pd-001, pd-002, pd-003"` |
| è¨­å®šä¾è³´ | `TASKS:` | `"TASKS: pd-002 depends on pd-001"` |
| æ‰€æœ‰ä»»å‹™å‰µå»ºå®Œæˆ | `TASKS:` + State | `"TASKS: [pd-001..pd-010] ready"` + done |

##### Minerï¼ˆCaravan æ¨¡å¼ï¼‰

| æ™‚æ©Ÿ | è¨˜éŒ„å…§å®¹ | ç¯„ä¾‹ |
|------|----------|------|
| é–‹å§‹å¯¦ä½œ | State | `bd agent state ... working` |
| **æ¯å®Œæˆä¸€å€‹ TDD cycle** | `PROGRESS:` | `"PROGRESS: 3/5 steps, files: src/auth.ts"` |
| æ¯æ¬¡ git commit | `PROGRESS:` | `"PROGRESS: Committed: feat(auth): add login"` |
| Context > 70% | `CHECKPOINT:` | `"CHECKPOINT: context=75%, current-file=src/auth.ts:125"` |
| ä»»å‹™å®Œæˆ | State + Status | `bd agent state ... done` + `--status ready-for-review` |

##### Assayerï¼ˆCaravan æ¨¡å¼ï¼‰

| æ™‚æ©Ÿ | è¨˜éŒ„å…§å®¹ | ç¯„ä¾‹ |
|------|----------|------|
| é–‹å§‹å¯©æŸ¥ | State | `bd agent state ... working` |
| æ¯å€‹æª”æ¡ˆå¯©æŸ¥å®Œ | `REVIEW:` | `"REVIEW: src/auth.ts - 2 issues found"` |
| å¯©æŸ¥å®Œæˆï¼ˆé€šéï¼‰ | `REVIEW:` | `"REVIEW: APPROVED - no critical issues"` |
| å¯©æŸ¥å®Œæˆï¼ˆä¸é€šéï¼‰ | `REVIEW:` | `"REVIEW: REJECTED - 3 issues require fix"` |
| Gate çµæœ | `REVIEW_GATE_1:` | `"REVIEW_GATE_1: status=pass, findings=[...]"` |

##### Canaryï¼ˆCaravan æ¨¡å¼ï¼‰

| æ™‚æ©Ÿ | è¨˜éŒ„å…§å®¹ | ç¯„ä¾‹ |
|------|----------|------|
| é–‹å§‹æ¸¬è©¦ | State | `bd agent state ... working` |
| æ¯å€‹æ¸¬è©¦å¥—ä»¶å®Œæˆ | `TEST-RESULT:` | `"TEST-RESULT: auth.spec.ts - 12 pass, 0 fail"` |
| æ¸¬è©¦å…¨éƒ¨é€šé | `TEST-RESULT:` | `"TEST-RESULT: pass, coverage=87%, 42 tests"` |
| æ¸¬è©¦å¤±æ•— | `TEST-RESULT:` | `"TEST-RESULT: fail, 2 failures: [list]"` |

##### Smelterï¼ˆCaravan æ¨¡å¼ï¼‰

| æ™‚æ©Ÿ | è¨˜éŒ„å…§å®¹ | ç¯„ä¾‹ |
|------|----------|------|
| é–‹å§‹å¯©è¨ˆ | State | `bd agent state ... working` |
| Lint å®Œæˆ | `AUDIT:` | `"AUDIT: lint - 0 errors, 3 warnings"` |
| é¡å‹æª¢æŸ¥å®Œæˆ | `AUDIT:` | `"AUDIT: typecheck - pass"` |
| å“è³ªå¯©è¨ˆå®Œæˆ | `AUDIT:` | `"AUDIT: pass - code quality acceptable"` |

##### Claim Agentï¼ˆAgent æ¨¡å¼ - é›™å¯«ï¼‰

| æ™‚æ©Ÿ | è¨˜éŒ„å…§å®¹ | ç¯„ä¾‹ |
|------|----------|------|
| ç™¼ç¾ QUESTION | è®€å– | `bd comments $PAYDIRT_CLAIM \| grep QUESTION` |
| å›ç­”å•é¡Œ | `ANSWER:` to Caravan | `"ANSWER [high]: Use Supabase Auth..."` |
| **åŒæ™‚** | `DECISION:` to Ledger | `bd comments add $LEDGER "DECISION caravan=..."` |
| è¨˜éŒ„æ±ºç­–æ‘˜è¦ | `DECISION-LOG:` to Caravan | `"DECISION-LOG: q=auth, a=Supabase, confidence=high"` |

##### Scoutï¼ˆSource æ¨¡å¼ï¼‰

| æ™‚æ©Ÿ | è¨˜éŒ„å…§å®¹ | ç¯„ä¾‹ |
|------|----------|------|
| ç™¼ç¾æ–°ä»»å‹™ | `DISCOVERY:` to Journal | `"DISCOVERY: [Linear] LIN-456 P1 assigned"` |
| æƒæå®Œæˆ | `SCAN:` to Journal | `"SCAN: Linear checked, 3 new P1 issues"` |
| å¤–éƒ¨ç‹€æ…‹è®Šæ›´ | `EXTERNAL:` to Journal | `"EXTERNAL: PR #123 merged"` |

#### CHECKPOINT æ ¼å¼è¦ç¯„

ç•¶ Context ä½¿ç”¨ç‡è¶…é 70% æ™‚ï¼Œå¿…é ˆè¨˜éŒ„å®Œæ•´ CHECKPOINTï¼š

```bash
bd comments add $PAYDIRT_CLAIM "CHECKPOINT: context=75%
state: implementing step 4/5
current-file: src/auth.ts:125
current-function: validateToken
next-action: Add expiry check
pending-tests: auth.spec.ts
uncommitted-changes: yes
last-commit: abc123"
```

**å¿…å¡«æ¬„ä½ï¼š**
- `context`: ç›®å‰ context ä½¿ç”¨ç™¾åˆ†æ¯”
- `state`: ç›®å‰åŸ·è¡Œç‹€æ…‹æè¿°
- `next-action`: ä¸‹ä¸€æ­¥è¦åšä»€éº¼

**é¸å¡«æ¬„ä½ï¼š**
- `current-file`: æ­£åœ¨ç·¨è¼¯çš„æª”æ¡ˆ
- `current-function`: æ­£åœ¨ç·¨è¼¯çš„å‡½æ•¸
- `pending-tests`: å¾…åŸ·è¡Œçš„æ¸¬è©¦
- `uncommitted-changes`: æ˜¯å¦æœ‰æœª commit çš„è®Šæ›´
- `last-commit`: æœ€å¾Œä¸€æ¬¡ commit hash

#### è¨˜éŒ„é »ç‡æª¢æŸ¥æ¸…å–®

æ¯å€‹ Prospect å•Ÿå‹•æ™‚æ‡‰æª¢æŸ¥ï¼š

```
[ ] 1. bd show $PAYDIRT_CLAIM - è®€å–ä»»å‹™
[ ] 2. bd agent state $PAYDIRT_CLAIM working - å®£å‘Šé–‹å§‹
[ ] 3. bd comments $PAYDIRT_CLAIM - æª¢æŸ¥ä¹‹å‰çš„ CHECKPOINTï¼ˆå¦‚æœ‰ï¼‰
```

æ¯å€‹ Prospect çµæŸæ™‚æ‡‰åŸ·è¡Œï¼š

```
[ ] 1. bd comments add $PAYDIRT_CLAIM "PROGRESS/OUTPUT/REVIEW/..." - è¨˜éŒ„çµæœ
[ ] 2. bd agent state $PAYDIRT_CLAIM done - æ¨™è¨˜å®Œæˆ
[ ] 3. bd update $PAYDIRT_CLAIM --status <next-status> - æ›´æ–°ç‹€æ…‹ï¼ˆå¦‚é©ç”¨ï¼‰
```

---

## 6. Camp Boss ä»»å‹™é€²ä»¶æµç¨‹

### é€²ä»¶ä¾†æº

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TASK INTAKE SOURCES                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   ğŸ”­ Scout Report              ğŸ‘‘ Chief Prospector (User)       â”‚
â”‚   (External: Linear,          (Direct command)                  â”‚
â”‚    GitHub, etc.)                                                â”‚
â”‚         â”‚                              â”‚                        â”‚
â”‚         â–¼                              â–¼                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚   â”‚ DISCOVERY â”‚                â”‚    REQUEST    â”‚                â”‚
â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚         â”‚                              â”‚                        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                        â–¼                                        â”‚
â”‚                 â›º Camp Boss                                     â”‚
â”‚                 (Intake Review)                                 â”‚
â”‚                        â”‚                                        â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚         â–¼              â–¼              â–¼                         â”‚
â”‚    ğŸšƒ Stake       ğŸ“‹ Backlog     âŒ Reject                      â”‚
â”‚   (New Caravan)   (Queue)        (Decline)                      â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æƒ…å¢ƒä¸€ï¼šScout å›å ±ï¼ˆå¤–éƒ¨ç™¼ç¾ï¼‰

```bash
# Scout ç™¼ç¾æ–°ä»»å‹™ï¼Œå›å ±åˆ° Camp Boss Journal
bd comments add $JOURNAL "DISCOVERY: [Linear] LIN-456 assigned
title: Fix authentication bug
priority: P1
assignee: @kent
url: https://linear.app/team/LIN-456"

# Camp Boss æ±ºç­–
bd comments add $JOURNAL "INTAKE_DECISION: LIN-456 â†’ STAKE
reason: P1 priority, auth system is critical
action: Starting new caravan"

# åŸ·è¡Œ
paydirt stake "Fix authentication bug (LIN-456)" --source linear:LIN-456
```

### æƒ…å¢ƒäºŒï¼šä½¿ç”¨è€…ç›´æ¥è«‹æ±‚

```bash
# 1. è¨˜éŒ„åˆ° Journal
bd comments add $JOURNAL "REQUEST: User wants notification system
scope: in-app only
priority: P1
linear: none (will create)"

# 2. å•Ÿå‹• Caravan
paydirt stake "Implement in-app notification system" --priority P1

# 3. è¨˜éŒ„æ±ºç­–
bd comments add $JOURNAL "INTAKE_DECISION: notification-system â†’ STAKE
source: user-request
caravan: caravan-xyz
priority: P1"
```

### Journal å‰ç¶´æ•´ç†

| å‰ç¶´ | ä¾†æº | èªªæ˜ |
|------|------|------|
| `DISCOVERY:` | Scout | å¤–éƒ¨ç™¼ç¾çš„ä»»å‹™ |
| `REQUEST:` | User | ä½¿ç”¨è€…ç›´æ¥è«‹æ±‚ |
| `INTAKE_DECISION:` | Camp Boss | é€²ä»¶æ±ºç­–è¨˜éŒ„ |
| `OBSERVATION:` | Camp Boss | ä¸€èˆ¬è§€å¯Ÿ |
| `GOAL_UPDATE:` | Camp Boss | ç›®æ¨™è®Šæ›´ |

---

## 7. Caravan äº¤ä»˜æµç¨‹

### äº¤ä»˜æµç¨‹ç¸½è¦½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CARAVAN DELIVERY FLOW                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   âœ… Implementation Complete                                    â”‚
â”‚            â”‚                                                    â”‚
â”‚            â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚   â”‚  REVIEW GATE 1  â”‚  superpowers:requesting-code-review      â”‚
â”‚   â”‚  (Assayer)      â”‚                                          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚            â”‚ pass                                               â”‚
â”‚            â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚   â”‚  REVIEW GATE 2  â”‚  code-review-toolkit:code-reviewer       â”‚
â”‚   â”‚  (Plugin)       â”‚                                          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚            â”‚ pass                                               â”‚
â”‚            â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚   â”‚   PR CREATION   â”‚  Based on repo's PR template             â”‚
â”‚   â”‚                 â”‚                                          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚            â”‚                                                    â”‚
â”‚            â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚   â”‚    CI GATE      â”‚  Wait for GitHub Actions                 â”‚
â”‚   â”‚                 â”‚                                          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚            â”‚ pass                                               â”‚
â”‚            â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚   â”‚   DELIVERED     â”‚  Ready for merge                         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### éšæ®µä¸€ï¼šSuperpowers Code Reviewï¼ˆAssayerï¼‰

```bash
# Miner å®Œæˆå¾Œ
bd update $PAYDIRT_CLAIM --status "ready-for-review"

# Assayer åŸ·è¡Œ superpowers:requesting-code-review
# è¨˜éŒ„çµæœ
bd comments add $PAYDIRT_CLAIM "REVIEW_GATE_1: superpowers-code-review
status: [pass|fail]
findings: [list]
action: [proceed|fix-required]"
```

### éšæ®µäºŒï¼šPlugin Code Review

```bash
# ä½¿ç”¨ code-review-toolkit agents
# - code-reviewer
# - silent-failure-hunter
# - type-design-analyzer (å¦‚é©ç”¨)

bd comments add $PAYDIRT_CLAIM "REVIEW_GATE_2: code-review-toolkit
agents_run: [list]
status: [pass|fail]
findings: [list]
action: [proceed|fix-required]"
```

### éšæ®µä¸‰ï¼šPR å‰µå»º

```bash
# è®€å– PR template
PR_TEMPLATE=$(cat .github/PULL_REQUEST_TEMPLATE.md 2>/dev/null)

# ä½¿ç”¨ superpowers:finishing-a-development-branch
# å‰µå»º PR
gh pr create --title "..." --body "..."

# è¨˜éŒ„
bd comments add $PAYDIRT_CLAIM "PR_CREATED: #123
url: https://github.com/owner/repo/pull/123
template_used: .github/PULL_REQUEST_TEMPLATE.md"
```

### éšæ®µå››ï¼šCI Gate

```bash
# ç­‰å¾… CI
gh pr checks <pr-number> --watch

# è¨˜éŒ„çµæœ
bd comments add $PAYDIRT_CLAIM "CI_GATE: [pass|fail]
checks: [list]
duration: Xm"
```

### éšæ®µäº”ï¼šäº¤ä»˜å®Œæˆ

```bash
bd update $PAYDIRT_CLAIM --status "delivered"
bd comments add $PAYDIRT_CLAIM "DELIVERED: PR #123 ready for merge"
bd comments add $JOURNAL "OBSERVATION: Caravan $PAYDIRT_CARAVAN delivered PR #123"
```

### ç‹€æ…‹æµè½‰

```
in_progress â†’ ready-for-review â†’ reviewing â†’ pr-created â†’ ci-pending â†’ delivered
                    â”‚                â”‚            â”‚
                    â””â”€â”€ fix-required â†â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Goldflow äº¤ä»˜ç®¡ç·šå®šç¾©

```yaml
# goldflow.yaml - delivery pipeline
pipelines:
  delivery:
    trigger: status == "ready-for-review"

    stages:
      - name: review-gate-1
        processor: assayer
        superpowers: [requesting-code-review]
        on_fail: return_to_miner

      - name: review-gate-2
        processor: code-review-toolkit
        agents: [code-reviewer, silent-failure-hunter]
        on_fail: return_to_miner

      - name: pr-creation
        processor: trail-boss
        superpowers: [finishing-a-development-branch]
        requires:
          - pr_template: .github/PULL_REQUEST_TEMPLATE.md

      - name: ci-gate
        verifier: github-actions
        timeout: 30m
        on_fail: return_to_miner

      - name: delivered
        sink: github-pr
        notify: camp-boss
```

---

## 8. è§’è‰²äº’å‹•ç‹€æ…‹æµç¨‹

æœ¬ç¯€æä¾›å®Œæ•´çš„ç«¯åˆ°ç«¯æµç¨‹åœ–ï¼Œèªªæ˜ç•¶ Camp Boss æ”¶åˆ°ä»»å‹™å¾Œï¼Œå„è§’è‰²å¦‚ä½•äº’å‹•èˆ‡ç‹€æ…‹æµè½‰ã€‚

### ä»»å‹™é€²ä»¶æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           TASK INTAKE FLOW                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   ğŸ”­ Scout                           ğŸ‘‘ Chief Prospector (User)             â”‚
â”‚   DISCOVERY:                         REQUEST:                               â”‚
â”‚   â””â”€> Linear/GitHub issue            â””â”€> Direct command                     â”‚
â”‚       priority, assignee                 "pd stake 'task'"                  â”‚
â”‚                    â”‚                              â”‚                         â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                               â–¼                                             â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚                    â”‚ â›º Camp Boss        â”‚                                   â”‚
â”‚                    â”‚   (Journal Mode)   â”‚                                   â”‚
â”‚                    â”‚   INTAKE_DECISION  â”‚                                   â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚                              â”‚                                              â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚              â–¼               â–¼               â–¼                              â”‚
â”‚         ğŸšƒ STAKE        ğŸ“‹ BACKLOG      âŒ REJECT                           â”‚
â”‚         (New Caravan)   (Queue)         (Decline)                           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Phase 1: Task Intakeï¼ˆé€²ä»¶éšæ®µï¼‰

**Camp Boss ç‹€æ…‹**

| ç‹€æ…‹ | èªªæ˜ |
|------|------|
| `INTAKE_DECISION` | è©•ä¼°ä»»å‹™å„ªå…ˆç´šèˆ‡å¯è¡Œæ€§ |
| `STAKE` | æ±ºå®šå•Ÿå‹•æ–° Caravan |

```bash
# Camp Boss Journal è¨˜éŒ„
bd comments add $JOURNAL "REQUEST: User wants notification system
scope: in-app only
priority: P1
linear: none"

bd comments add $JOURNAL "INTAKE_DECISION: notification-system â†’ STAKE
source: user-request
caravan: caravan-xyz
priority: P1"
```

### Phase 2: Caravan Creationï¼ˆè»ŠéšŠå‰µå»ºï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CARAVAN CREATION                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Camp Boss executes:                                                       â”‚
â”‚   â””â”€> paydirt stake "Implement notification system" --priority P1           â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  1. Creates bd epic with label paydirt:caravan                        â”‚  â”‚
â”‚   â”‚  2. Creates tmux session: paydirt-<claim-id>                         â”‚  â”‚
â”‚   â”‚  3. Sets environment variables:                                       â”‚  â”‚
â”‚   â”‚     - PAYDIRT_CLAIM=pd-xxx                                           â”‚  â”‚
â”‚   â”‚     - PAYDIRT_CARAVAN=notification-system                            â”‚  â”‚
â”‚   â”‚     - PAYDIRT_SESSION=paydirt-pd-xxx                                 â”‚  â”‚
â”‚   â”‚  4. Spawns ğŸ¤  Trail Boss in Caravan                                   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Phase 3: Planningï¼ˆè¦åŠƒéšæ®µï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PLANNING PHASE                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   ğŸ¤  Trail Boss                                                             â”‚
â”‚   â”œâ”€> State: working                                                        â”‚
â”‚   â”œâ”€> bd agent state $PAYDIRT_CLAIM working                                â”‚
â”‚   â”œâ”€> Check for $PAYDIRT_TUNNEL (Autopilot mode context)                   â”‚
â”‚   â”‚                                                                         â”‚
â”‚   â”‚   IF Prime Mode:                                                        â”‚
â”‚   â”‚   â””â”€> Write QUESTION: to bd, wait for Claim Agent ANSWER:              â”‚
â”‚   â”‚                                                                         â”‚
â”‚   â”‚   IF Manual Mode:                                                       â”‚
â”‚   â”‚   â””â”€> AskUserQuestion for clarification                                â”‚
â”‚   â”‚                                                                         â”‚
â”‚   â””â”€> Spawns ğŸ“ Surveyor:                                                   â”‚
â”‚       $PAYDIRT_BIN prospect surveyor --task "Design notification system"   â”‚
â”‚                                                                             â”‚
â”‚   ğŸ“ Surveyor                                                               â”‚
â”‚   â”œâ”€> State: working                                                        â”‚
â”‚   â”œâ”€> Invokes: superpowers:brainstorming                                   â”‚
â”‚   â”œâ”€> Invokes: superpowers:writing-plans                                   â”‚
â”‚   â”œâ”€> OUTPUT: docs/plans/YYYY-MM-DD-notification-design.md                  â”‚
â”‚   â””â”€> bd comments add $PAYDIRT_CLAIM "OUTPUT: design=docs/plans/..."       â”‚
â”‚       bd agent state $PAYDIRT_CLAIM done                                   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Phase 4: Task Breakdownï¼ˆä»»å‹™åˆ†è§£ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         TASK BREAKDOWN                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   ğŸ¤  Trail Boss (receives Surveyor completion)                              â”‚
â”‚   â””â”€> Spawns ğŸ‘· Shift Boss:                                                 â”‚
â”‚       $PAYDIRT_BIN prospect shift-boss --task "Create tasks from design"   â”‚
â”‚                                                                             â”‚
â”‚   ğŸ‘· Shift Boss                                                             â”‚
â”‚   â”œâ”€> State: working                                                        â”‚
â”‚   â”œâ”€> Reads: docs/plans/YYYY-MM-DD-notification-design.md                  â”‚
â”‚   â”œâ”€> Invokes: superpowers:subagent-driven-development                     â”‚
â”‚   â”œâ”€> Creates bd sub-tasks:                                                â”‚
â”‚   â”‚   bd create --title "Task 1: Setup DB schema" --type task              â”‚
â”‚   â”‚   bd create --title "Task 2: Implement API" --type task                â”‚
â”‚   â”‚   bd create --title "Task 3: Build UI" --type task                     â”‚
â”‚   â”‚   bd dep add pd-task-2 pd-task-1  # API depends on schema              â”‚
â”‚   â”‚                                                                         â”‚
â”‚   â””â”€> bd comments add $PAYDIRT_CLAIM "TASKS: [pd-task-1, pd-task-2, ...]"  â”‚
â”‚       bd agent state $PAYDIRT_CLAIM done                                   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Phase 5: Implementationï¼ˆå¯¦ä½œéšæ®µï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         IMPLEMENTATION                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   ğŸ¤  Trail Boss                                                             â”‚
â”‚   â””â”€> Invokes: superpowers:dispatching-parallel-agents                     â”‚
â”‚   â””â”€> Spawns â›ï¸ Miners for independent tasks:                              â”‚
â”‚       $PAYDIRT_BIN prospect miner --task "Implement: Setup DB schema"      â”‚
â”‚                                                                             â”‚
â”‚   â›ï¸ Miner (per task)                                                       â”‚
â”‚   â”œâ”€> State: working                                                        â”‚
â”‚   â”œâ”€> bd show $PAYDIRT_CLAIM (read task details)                           â”‚
â”‚   â”œâ”€> Invokes: superpowers:executing-plans                                 â”‚
â”‚   â”œâ”€> Invokes: superpowers:test-driven-development                         â”‚
â”‚   â”‚                                                                         â”‚
â”‚   â”‚   TDD Loop:                                                             â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚   â”‚   â”‚  1. Write failing test                  â”‚                          â”‚
â”‚   â”‚   â”‚  2. Implement minimal code              â”‚                          â”‚
â”‚   â”‚   â”‚  3. Verify test passes                  â”‚                          â”‚
â”‚   â”‚   â”‚  4. Commit                              â”‚                          â”‚
â”‚   â”‚   â”‚  5. bd comments add "PROGRESS: X/Y"     â”‚                          â”‚
â”‚   â”‚   â”‚  6. Repeat                              â”‚                          â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚   â”‚                                                                         â”‚
â”‚   â”œâ”€> Context Check (if > 80%):                                            â”‚
â”‚   â”‚   bd comments add "CHECKPOINT: context=85%, state=..."                 â”‚
â”‚   â”‚   bd agent state $PAYDIRT_CLAIM stuck â†’ triggers respawn               â”‚
â”‚   â”‚                                                                         â”‚
â”‚   â””â”€> On completion:                                                        â”‚
â”‚       bd update $PAYDIRT_CLAIM --status "ready-for-review"                 â”‚
â”‚       bd agent state $PAYDIRT_CLAIM done                                   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Phase 6: Delivery Pipelineï¼ˆäº¤ä»˜ç®¡ç·šï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DELIVERY PIPELINE                                   â”‚
â”‚                      (Goldflow Verifier Chain)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Trigger: status == "ready-for-review"                                     â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ GATE 1: ğŸ”¬ Assayer (superpowers:requesting-code-review)             â”‚   â”‚
â”‚   â”‚ â”œâ”€> bd comments add "REVIEW_GATE_1: superpowers-code-review         â”‚   â”‚
â”‚   â”‚ â”‚   status: [pass|fail]"                                            â”‚   â”‚
â”‚   â”‚ â””â”€> On fail â†’ return_to_miner                                       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â–¼ pass                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ GATE 2: code-review-toolkit agents                                  â”‚   â”‚
â”‚   â”‚ â”œâ”€> code-reviewer                                                   â”‚   â”‚
â”‚   â”‚ â”œâ”€> silent-failure-hunter                                           â”‚   â”‚
â”‚   â”‚ â”œâ”€> type-design-analyzer (if applicable)                            â”‚   â”‚
â”‚   â”‚ â””â”€> bd comments add "REVIEW_GATE_2: code-review-toolkit             â”‚   â”‚
â”‚   â”‚     agents_run: [...], status: [pass|fail]"                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â–¼ pass                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ PR CREATION: ğŸ¤  Trail Boss                                          â”‚   â”‚
â”‚   â”‚ â”œâ”€> superpowers:finishing-a-development-branch                      â”‚   â”‚
â”‚   â”‚ â”œâ”€> Reads .github/PULL_REQUEST_TEMPLATE.md                          â”‚   â”‚
â”‚   â”‚ â”œâ”€> gh pr create --title "..." --body "..."                         â”‚   â”‚
â”‚   â”‚ â””â”€> bd comments add "PR_CREATED: #123"                              â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â–¼                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ CI GATE: GitHub Actions                                             â”‚   â”‚
â”‚   â”‚ â”œâ”€> gh pr checks <pr-number> --watch                                â”‚   â”‚
â”‚   â”‚ â””â”€> bd comments add "CI_GATE: [pass|fail]"                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â–¼ pass                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ DELIVERED                                                           â”‚   â”‚
â”‚   â”‚ â”œâ”€> bd update $PAYDIRT_CLAIM --status "delivered"                   â”‚   â”‚
â”‚   â”‚ â””â”€> bd comments add $JOURNAL "OBSERVATION: Caravan delivered #123"  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç‹€æ…‹æµè½‰ç¸½è¦½

```
                               CARAVAN STATUS FLOW
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚                                                                            â”‚
 â”‚  open â”€â”€â–¶ in_progress â”€â”€â–¶ ready-for-review â”€â”€â–¶ reviewing â”€â”€â–¶ pr-created   â”‚
 â”‚                                  â”‚                â”‚            â”‚           â”‚
 â”‚                                  â”‚                â”‚            â”‚           â”‚
 â”‚                                  â””â”€â”€ fix-required â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
 â”‚                                                                            â”‚
 â”‚  pr-created â”€â”€â–¶ ci-pending â”€â”€â–¶ delivered â”€â”€â–¶ closed                        â”‚
 â”‚                      â”‚                                                     â”‚
 â”‚                      â””â”€â”€ fix-required                                      â”‚
 â”‚                                                                            â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è§’è‰²ç‹€æ…‹å°ç…§è¡¨

| Prospect | Goldflow | è§¸ç™¼æ™‚æ©Ÿ | è¼¸å…¥ | è¼¸å‡º | Superpowers |
|----------|----------|----------|------|------|-------------|
| **Camp Boss** | Controller | ä»»å‹™é€²ä»¶ | Scout DISCOVERY / User REQUEST | INTAKE_DECISION | `dispatching-parallel-agents` |
| **Trail Boss** | Controller | Caravan å‰µå»ºå¾Œ | ä»»å‹™æè¿° | å”èª¿æŒ‡ä»¤ | `dispatching-parallel-agents`, `finishing-a-development-branch` |
| **Surveyor** | Stage | Trail Boss å§”æ´¾ | ä»»å‹™æè¿° | è¨­è¨ˆæ–‡æª” | `brainstorming`, `writing-plans` |
| **Shift Boss** | Controller | è¨­è¨ˆå®Œæˆå¾Œ | è¨­è¨ˆæ–‡æª” | bd ä»»å‹™åˆ—è¡¨ | `subagent-driven-development` |
| **Miner** | Processor | Shift Boss åˆ†é…å¾Œ | å…·é«”ä»»å‹™ | ç¨‹å¼ç¢¼ + æ¸¬è©¦ | `executing-plans`, `test-driven-development` |
| **Assayer** | Verifier | ready-for-review | ç¨‹å¼ç¢¼è®Šæ›´ | å¯©æŸ¥çµæœ | `requesting-code-review` |
| **Canary** | Verifier | æ¸¬è©¦éšæ®µ | ç¨‹å¼ç¢¼ | æ¸¬è©¦å ±å‘Š | `verification-before-completion` |
| **Smelter** | Verifier | å“è³ªæ”¹å–„ | ç¨‹å¼ç¢¼ | é‡æ§‹çµæœ | `systematic-debugging` |
| **Claim Agent** | Controller | Prime Mode å•é¡Œ | QUESTION: | ANSWER: | (æ±ºç­–è·¯ç”±) |
| **Scout** | Source | å®šæœŸæƒæ | Linear/GitHub | DISCOVERY: | (å¤–éƒ¨è³‡æ–™) |

---

## 9. Event-Driven æ¶æ§‹èˆ‡ bd Message Bus

æœ¬ç¯€èªªæ˜ Paydirt çš„æ ¸å¿ƒé€šè¨Šæ©Ÿåˆ¶ï¼šç‚ºä½•é¸æ“‡ Event-Driven æ¶æ§‹è€Œé Claude å…§å»º Subagentï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ bd CLI ä½œç‚º Message Busã€‚

### 9.1 æ¶æ§‹é¸æ“‡ï¼šç‚ºä½•ä¸ä½¿ç”¨ Claude Subagent

Paydirt **ä¸ä½¿ç”¨** Claude å…§å»ºçš„ Task tool (Subagent)ï¼Œè€Œæ˜¯è®“æ¯å€‹ Prospect ä½œç‚º**ç¨ç«‹çš„ Claude process**ï¼Œé€é bd CLI é€²è¡Œé€šè¨Šã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 SUBAGENT vs EVENT-DRIVEN COMPARISON                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Claude Subagent (Task tool)          Paydirt Event-Driven                 â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚  Claude Process A   â”‚              â”‚  Claude Process A   â”‚              â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚              â”‚  (Trail Boss)       â”‚              â”‚
â”‚   â”‚  â”‚ Subagent B    â”‚  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚   â”‚  â”‚ (child)       â”‚  â”‚                         â”‚                         â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚              bd commentsâ”‚(Message Bus)            â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                         â”‚                         â”‚
â”‚   â”‚  â”‚ Subagent C    â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚  â”‚ (child)       â”‚  â”‚              â”‚  Claude Process B   â”‚              â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚              â”‚  (Surveyor)         â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                             â”‚
â”‚   Single API session                   Multiple independent sessions        â”‚
â”‚   Shared context (200K limit)          Each has own 200K context           â”‚
â”‚   No persistence                       Git-backed persistence               â”‚
â”‚   Cannot pause/inspect                 tmux: can attach anytime             â”‚
â”‚   No respawn on exhaustion             CHECKPOINT â†’ respawn supported       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é¸æ“‡ Event-Driven çš„ç†ç”±ï¼š**

| è€ƒé‡ | Subagent | Event-Driven | å„ªå‹ |
|------|----------|--------------|------|
| **Context éš”é›¢** | å…±äº« parent context | å„è‡ªç¨ç«‹ 200K | Event-Driven |
| **é•·ä»»å‹™æ”¯æ´** | Context exhaustion å¾Œç„¡æ³•æ¢å¾© | CHECKPOINT + respawn | Event-Driven |
| **äººé¡ä»‹å…¥** | åŸ·è¡Œä¸­ç„¡æ³• pause | tmux éš¨æ™‚ attach | Event-Driven |
| **æŒä¹…åŒ–** | ç„¡ï¼Œsession çµæŸå³æ¶ˆå¤± | bd Git-backed | Event-Driven |
| **å¯è§€æ¸¬æ€§** | çµæœæ˜¯ text blob | çµæ§‹åŒ– bd comments | Event-Driven |
| **çœŸæ­£ä¸¦è¡Œ** | å—é™å–®ä¸€ session | å¤š tmux panes ä¸¦è¡Œ | Event-Driven |
| **æˆæœ¬** | å–®ä¸€ API call | å¤šå€‹ API calls | Subagent |
| **ç°¡å–®ä»»å‹™** | é©åˆ | éæ–¼è¤‡é›œ | Subagent |

**çµè«–**ï¼šPaydirt çš„ç›®æ¨™æ˜¯é•·æ™‚é–“ã€è¤‡é›œã€éœ€è¦äººé¡ä»‹å…¥çš„å¤š agent å”ä½œï¼Œå› æ­¤é¸æ“‡ Event-Driven æ¶æ§‹ã€‚

### 9.2 bd CLI ä½œç‚º Message Bus

bd CLI çš„ `comments` åŠŸèƒ½æ˜¯ Paydirt çš„æ ¸å¿ƒé€šè¨Šæ©Ÿåˆ¶ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BD AS MESSAGE BUS                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Publisher                    Message Bus                    Subscriber    â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚                                                                             â”‚
â”‚   Trail Boss    â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶    .beads/*.jsonl    â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶    Claim Agent  â”‚
â”‚   writes:                     (Git-backed)                    polls:        â”‚
â”‚   QUESTION:                                                   grep QUESTION â”‚
â”‚                                                                             â”‚
â”‚   Surveyor      â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶         â”‚            â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶    Trail Boss   â”‚
â”‚   writes:                          â”‚                          polls:        â”‚
â”‚   OUTPUT:                          â”‚                          grep OUTPUT   â”‚
â”‚                                    â”‚                                        â”‚
â”‚   Miner         â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶         â”‚            â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶    Respawn      â”‚
â”‚   writes:                          â”‚                          System        â”‚
â”‚   CHECKPOINT:                      â”‚                          polls:        â”‚
â”‚                                    â”‚                          grep CHECKPOINTâ”‚
â”‚                                    â”‚                                        â”‚
â”‚   bd comments add â”€â”€â”€â”€â”€â”€â”€â”€â–¶   bd comments â”€â”€â”€â”€â–¶   bd comments | grep       â”‚
â”‚   (publish)                   (storage)           (subscribe)               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Message Bus ç‰¹æ€§ï¼š**

| ç‰¹æ€§ | èªªæ˜ |
|------|------|
| **æŒä¹…åŒ–** | Git-backed JSONLï¼Œå¯è¿½æº¯æ­·å² |
| **å¯æœå°‹** | `bd comments <id> \| grep <prefix>` |
| **çµæ§‹åŒ–** | JSON è¼¸å‡ºï¼š`bd comments <id> --json` |
| **éåŒæ­¥** | Publisher ä¸éœ€ç­‰å¾… Subscriber |
| **å»£æ’­** | å¤šå€‹ Subscriber å¯åŒæ™‚è®€å– |

### 9.3 Comment Prefix = Event Type

æ¯å€‹ comment å‰ç¶´ä»£è¡¨ä¸€ç¨® Event Typeï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      COMMENT PREFIX = EVENT TYPE                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   PREFIX           â”‚ EVENT TYPE      â”‚ PUBLISHER      â”‚ SUBSCRIBER          â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚   QUESTION:        â”‚ æ±ºç­–è«‹æ±‚        â”‚ Trail Boss     â”‚ Claim Agent         â”‚
â”‚   ANSWER:          â”‚ æ±ºç­–å›è¦†        â”‚ Claim Agent    â”‚ Trail Boss          â”‚
â”‚   OUTPUT:          â”‚ ç”¢å‡ºå®Œæˆ        â”‚ Any Prospect   â”‚ Trail Boss          â”‚
â”‚   PROGRESS:        â”‚ é€²åº¦æ›´æ–°        â”‚ Any Prospect   â”‚ Monitor             â”‚
â”‚   CHECKPOINT:      â”‚ æ–·é»è¨˜éŒ„        â”‚ Any Prospect   â”‚ Respawn System      â”‚
â”‚   DISCOVERY:       â”‚ å¤–éƒ¨ç™¼ç¾        â”‚ Scout          â”‚ Camp Boss           â”‚
â”‚   TASKS:           â”‚ ä»»å‹™åˆ—è¡¨        â”‚ Shift Boss     â”‚ Trail Boss          â”‚
â”‚   REVIEW:          â”‚ å¯©æŸ¥çµæœ        â”‚ Assayer        â”‚ Trail Boss          â”‚
â”‚   TEST-RESULT:     â”‚ æ¸¬è©¦çµæœ        â”‚ Canary         â”‚ Trail Boss          â”‚
â”‚   AUDIT:           â”‚ å¯©è¨ˆçµæœ        â”‚ Smelter        â”‚ Trail Boss          â”‚
â”‚   DECISION:        â”‚ æ±ºç­–è¨˜éŒ„        â”‚ Trail Boss     â”‚ Ledger              â”‚
â”‚   ESCALATE:        â”‚ å‡ç´šäººé¡        â”‚ Claim Agent    â”‚ Human               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¯„ä¾‹ï¼š**

```bash
# Trail Boss ç™¼é€æ±ºç­–è«‹æ±‚
bd comments add $PAYDIRT_CLAIM "QUESTION [decision]: Which auth provider?
OPTIONS:
- Supabase Auth
- Firebase Auth
- Custom JWT"

# Claim Agent å›è¦†
bd comments add $PAYDIRT_CLAIM "ANSWER [high]: Use Supabase Auth.
Reasoning: Context file specifies 'Use Supabase ecosystem'."

# Surveyor å®Œæˆè¨­è¨ˆ
bd comments add $PAYDIRT_CLAIM "OUTPUT: design=docs/plans/2026-01-09-auth-design.md"

# Miner è¨˜éŒ„æ–·é»
bd comments add $PAYDIRT_CLAIM "CHECKPOINT: context=85%
state: implementing step 4/5
current-file: src/auth.ts:125
next-action: Add token validation"
```

### 9.4 Event Polling æ©Ÿåˆ¶

Prospect é€é polling bd comments ä¾†åµæ¸¬äº‹ä»¶ï¼š

```bash
#!/bin/bash
# event-polling-example.sh - Trail Boss ç­‰å¾… Surveyor å®Œæˆ

CLAIM_ID=$PAYDIRT_CLAIM
TIMEOUT=300  # 5 minutes
INTERVAL=5   # Check every 5 seconds
ELAPSED=0

echo "Waiting for Surveyor OUTPUT..."

while [ $ELAPSED -lt $TIMEOUT ]; do
  # Poll for OUTPUT event
  OUTPUT=$(bd comments $CLAIM_ID 2>/dev/null | grep "^OUTPUT:" | tail -1)

  if [ -n "$OUTPUT" ]; then
    echo "Received: $OUTPUT"
    # Extract design path
    DESIGN_PATH=$(echo "$OUTPUT" | sed 's/OUTPUT: design=//')
    echo "Design document: $DESIGN_PATH"
    exit 0
  fi

  sleep $INTERVAL
  ELAPSED=$((ELAPSED + INTERVAL))
done

echo "Timeout waiting for OUTPUT"
exit 1
```

**Polling ç­–ç•¥ï¼š**

| Event Type | Polling é »ç‡ | Timeout | è™•ç†æ–¹å¼ |
|------------|-------------|---------|----------|
| `ANSWER:` | 2-3 ç§’ | 5 åˆ†é˜ | ç­‰å¾…æˆ–å‡ç´šäººé¡ |
| `OUTPUT:` | 5 ç§’ | 30 åˆ†é˜ | ç­‰å¾…æˆ–æª¢æŸ¥ stuck |
| `CHECKPOINT:` | 10 ç§’ | - | Respawn ç³»çµ±ç›£æ§ |
| `DISCOVERY:` | 60 ç§’ | - | Camp Boss å®šæœŸæƒæ |

### 9.5 Claude Hooks æ•´åˆ

Claude Code Hooks å¯è‡ªå‹•åŒ–äº‹ä»¶åµæ¸¬ï¼Œå–ä»£æ‰‹å‹• pollingã€‚

**Hook Events èˆ‡ Paydirt æ•´åˆï¼š**

| Hook Event | Paydirt ç”¨é€” |
|------------|-------------|
| `SessionStart` | è¼‰å…¥ bd contextã€è®€å– CHECKPOINT |
| `PostToolUse` | åµæ¸¬ bd comments è®ŠåŒ–ã€è‡ªå‹•æ´¾å‡º Claim Agent |
| `PreToolUse` | å­˜å–æ§åˆ¶ï¼ˆé˜»æ­¢ Camp Boss ç·¨è¼¯æª”æ¡ˆï¼‰ |
| `Stop` | é©—è­‰æ˜¯å¦çœŸçš„å®Œæˆã€æª¢æŸ¥ pending questions |
| `PreCompact` | å¯«å…¥ CHECKPOINT åˆ° bd |

**è¨­å®šç¯„ä¾‹ (`.claude/settings.json`)ï¼š**

```json
{
  "hooks": {
    "SessionStart": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "bd prime"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "$CLAUDE_PROJECT_DIR/.paydirt/hooks/question-dispatcher.sh"
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Edit|Write",
        "hooks": [
          {
            "type": "command",
            "command": "[ \"$PAYDIRT_PROSPECT\" = 'camp-boss' ] && echo '{\"hookSpecificOutput\":{\"permissionDecision\":\"deny\",\"permissionDecisionReason\":\"Camp Boss delegates, does not edit\"}}' && exit 0 || exit 0"
          }
        ]
      }
    ],
    "PreCompact": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "bd comments add $PAYDIRT_CLAIM \"CHECKPOINT: context=compacting, state=$(bd show $PAYDIRT_CLAIM --json | jq -r .status)\""
          }
        ]
      }
    ]
  }
}
```

**è‡ªå‹• Question Dispatcher Hookï¼š**

```bash
#!/bin/bash
# .paydirt/hooks/question-dispatcher.sh
# PostToolUse hook: è‡ªå‹•åµæ¸¬æœªå›ç­”çš„ QUESTION ä¸¦æ´¾å‡º Claim Agent

[ -z "$PAYDIRT_CLAIM" ] && exit 0

# è¨ˆç®—æœªå›ç­”çš„å•é¡Œæ•¸
QUESTIONS=$(bd comments $PAYDIRT_CLAIM 2>/dev/null | grep -c "^QUESTION:")
ANSWERS=$(bd comments $PAYDIRT_CLAIM 2>/dev/null | grep -c "^ANSWER:")

if [ $QUESTIONS -gt $ANSWERS ]; then
  # æª¢æŸ¥ Claim Agent æ˜¯å¦å·²åœ¨é‹è¡Œ
  CLAIM_AGENT_RUNNING=$(bd list --label paydirt:prospect --assignee claim-agent --status in_progress --brief 2>/dev/null | wc -l)

  if [ "$CLAIM_AGENT_RUNNING" -eq 0 ]; then
    echo "Detected unanswered questions ($QUESTIONS Q, $ANSWERS A), spawning Claim Agent" >&2
    $PAYDIRT_BIN prospect claim-agent --background &
  fi
fi

exit 0
```

### 9.6 å®Œæ•´ Event Flow ç¯„ä¾‹

ä»¥ä¸‹æ˜¯å®Œæ•´çš„ event-driven æµç¨‹ï¼Œå±•ç¤ºå¾ä»»å‹™é€²ä»¶åˆ°å®Œæˆçš„æ‰€æœ‰äº‹ä»¶ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    COMPLETE EVENT FLOW EXAMPLE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  TIME    â”‚ ACTOR         â”‚ ACTION                â”‚ BD COMMAND               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  T+0     â”‚ Human         â”‚ pd stake "Auth"       â”‚ bd create --type epic    â”‚
â”‚  T+1     â”‚ CLI           â”‚ Create Caravan        â”‚ bd update --status open  â”‚
â”‚  T+2     â”‚ CLI           â”‚ Spawn Trail Boss      â”‚ tmux + claude --agent    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  T+3     â”‚ Trail Boss    â”‚ Start working         â”‚ bd agent state working   â”‚
â”‚  T+4     â”‚ Trail Boss    â”‚ Need decision         â”‚ bd comments add          â”‚
â”‚          â”‚               â”‚                       â”‚ "QUESTION [decision]:    â”‚
â”‚          â”‚               â”‚                       â”‚ Which auth provider?"    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  T+5     â”‚ Hook          â”‚ Detect QUESTION       â”‚ (PostToolUse triggered)  â”‚
â”‚  T+6     â”‚ Hook          â”‚ Spawn Claim Agent     â”‚ pd prospect claim-agent  â”‚
â”‚  T+7     â”‚ Claim Agent   â”‚ Read context file     â”‚ cat $PAYDIRT_TUNNEL      â”‚
â”‚  T+8     â”‚ Claim Agent   â”‚ Answer question       â”‚ bd comments add          â”‚
â”‚          â”‚               â”‚                       â”‚ "ANSWER [high]: Supabase"â”‚
â”‚  T+9     â”‚ Claim Agent   â”‚ Exit                  â”‚ (process ends)           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  T+10    â”‚ Trail Boss    â”‚ Poll sees ANSWER      â”‚ bd comments | grep ANSWERâ”‚
â”‚  T+11    â”‚ Trail Boss    â”‚ Spawn Surveyor        â”‚ pd prospect surveyor     â”‚
â”‚  T+12    â”‚ Surveyor      â”‚ Start design          â”‚ bd agent state working   â”‚
â”‚  T+13    â”‚ Surveyor      â”‚ Use brainstorming     â”‚ Skill(brainstorming)     â”‚
â”‚  T+14    â”‚ Surveyor      â”‚ Write plan            â”‚ Write to docs/plans/     â”‚
â”‚  T+15    â”‚ Surveyor      â”‚ Report output         â”‚ bd comments add          â”‚
â”‚          â”‚               â”‚                       â”‚ "OUTPUT: design=..."     â”‚
â”‚  T+16    â”‚ Surveyor      â”‚ Done                  â”‚ bd agent state done      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  T+17    â”‚ Trail Boss    â”‚ Poll sees OUTPUT      â”‚ bd comments | grep OUTPUTâ”‚
â”‚  T+18    â”‚ Trail Boss    â”‚ Spawn Shift Boss      â”‚ pd prospect shift-boss   â”‚
â”‚  T+19    â”‚ Shift Boss    â”‚ Create tasks          â”‚ bd create (multiple)     â”‚
â”‚  T+20    â”‚ Shift Boss    â”‚ Report tasks          â”‚ bd comments add          â”‚
â”‚          â”‚               â”‚                       â”‚ "TASKS: [pd-001,...]"    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  T+21    â”‚ Trail Boss    â”‚ Poll sees TASKS       â”‚ bd comments | grep TASKS â”‚
â”‚  T+22    â”‚ Trail Boss    â”‚ Spawn Miners (//l)    â”‚ pd prospect miner (x3)   â”‚
â”‚  T+23-99 â”‚ Miners        â”‚ Implement + TDD       â”‚ bd comments add PROGRESS â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  T+100   â”‚ Miner #1      â”‚ Context 85%           â”‚ bd comments add          â”‚
â”‚          â”‚               â”‚                       â”‚ "CHECKPOINT: context=85%"â”‚
â”‚  T+101   â”‚ Miner #1      â”‚ Mark stuck            â”‚ bd agent state stuck     â”‚
â”‚  T+102   â”‚ Respawn       â”‚ Detect stuck          â”‚ (monitoring system)      â”‚
â”‚  T+103   â”‚ Respawn       â”‚ Spawn new Miner       â”‚ pd prospect miner        â”‚
â”‚          â”‚               â”‚                       â”‚ --checkpoint             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  T+150   â”‚ All Miners    â”‚ Complete              â”‚ bd agent state done      â”‚
â”‚  T+151   â”‚ Trail Boss    â”‚ Update status         â”‚ bd update                â”‚
â”‚          â”‚               â”‚                       â”‚ --status ready-for-reviewâ”‚
â”‚  T+152   â”‚ Trail Boss    â”‚ Spawn Assayer         â”‚ pd prospect assayer      â”‚
â”‚  T+153   â”‚ Assayer       â”‚ Review code           â”‚ Skill(code-review)       â”‚
â”‚  T+154   â”‚ Assayer       â”‚ Report result         â”‚ bd comments add          â”‚
â”‚          â”‚               â”‚                       â”‚ "REVIEW: APPROVED"       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  T+155   â”‚ Trail Boss    â”‚ Create PR             â”‚ gh pr create             â”‚
â”‚  T+156   â”‚ Trail Boss    â”‚ Report PR             â”‚ bd comments add          â”‚
â”‚          â”‚               â”‚                       â”‚ "PR_CREATED: #123"       â”‚
â”‚  T+157   â”‚ Trail Boss    â”‚ Mark delivered        â”‚ bd update                â”‚
â”‚          â”‚               â”‚                       â”‚ --status delivered       â”‚
â”‚  T+158   â”‚ Trail Boss    â”‚ Notify Camp Boss      â”‚ bd comments add $JOURNAL â”‚
â”‚          â”‚               â”‚                       â”‚ "OBSERVATION: delivered" â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.7 Event-Driven æœ€ä½³å¯¦è¸

**Publisher è¦å‰‡ï¼š**

1. ä½¿ç”¨æ¨™æº–å‰ç¶´ï¼ˆQUESTION:, OUTPUT:, PROGRESS: ç­‰ï¼‰
2. å¯«å…¥å¾Œç«‹å³å¯è¢«è®€å–ï¼ˆbd æ˜¯åŒæ­¥çš„ï¼‰
3. åŒ…å«è¶³å¤  context è®“ subscriber å¯ä»¥è¡Œå‹•
4. é•·å…§å®¹ä½¿ç”¨å¤šè¡Œæ ¼å¼

**Subscriber è¦å‰‡ï¼š**

1. ä½¿ç”¨ `grep` éæ¿¾ç‰¹å®š prefix
2. ä½¿ç”¨ `tail -1` å–æœ€æ–°äº‹ä»¶ï¼ˆå¦‚é©ç”¨ï¼‰
3. è™•ç†å¾Œè€ƒæ…®æ˜¯å¦éœ€è¦ ACKï¼ˆå¯«å…¥å›æ‡‰ï¼‰
4. è¨­å®šåˆç† timeout é¿å…ç„¡é™ç­‰å¾…

**Hook è¦å‰‡ï¼š**

1. Hook æ‡‰è©²å¿«é€ŸåŸ·è¡Œï¼ˆ< 1 ç§’ï¼‰
2. é•·æ“ä½œä½¿ç”¨ `&` èƒŒæ™¯åŸ·è¡Œ
3. æª¢æŸ¥ç’°å¢ƒè®Šæ•¸é¿å…åœ¨éŒ¯èª¤ context åŸ·è¡Œ
4. ä½¿ç”¨ exit 0 è¡¨ç¤ºæˆåŠŸï¼ˆä¸é˜»æ­¢æ“ä½œï¼‰

---

## 10. CLI èˆ‡ç’°å¢ƒè®Šæ•¸

### CLI å‘½ä»¤è¨­è¨ˆ

```bash
# ä¸»å‘½ä»¤
paydirt <command> [options]

# æˆ–ç°¡å¯«
pd <command> [options]
```

| å‘½ä»¤ | èªªæ˜ | æé‡‘éš±å–» |
|------|------|----------|
| `paydirt stake "task"` | å•Ÿå‹•æ–° Caravan | æ’æ——å®£ç¤ºç¤¦æ¬Š |
| `paydirt continue [id]` | æ¢å¾©æ—¢æœ‰ Caravan | ç¹¼çºŒæŒ–æ˜ |
| `paydirt survey [id]` | æŸ¥çœ‹ç‹€æ…‹ | å‹˜æ¸¬é€²åº¦ |
| `paydirt abandon [id]` | åœæ­¢ Caravan | æ”¾æ£„ç¤¦å€ |
| `paydirt prospect <role>` | æ´¾å‡ºç‰¹å®šè§’è‰² | æ´¾å‡ºæ¢å‹˜è€… |
| `paydirt boomtown` | é–‹å•Ÿ Dashboard | é€²å…¥ç¹æ¦®é® |
| `paydirt ledger` | æŸ¥çœ‹æ­·å²è¨˜éŒ„ | ç¿»é–±å¸³ç°¿ |

### ç’°å¢ƒè®Šæ•¸

| è®Šæ•¸ | èªªæ˜ |
|------|------|
| `PAYDIRT_CLAIM` | ç•¶å‰ Claimï¼ˆbd issueï¼‰ID |
| `PAYDIRT_CARAVAN` | Caravan åç¨± |
| `PAYDIRT_PROSPECT` | ç•¶å‰ Prospect è§’è‰² |
| `PAYDIRT_SESSION` | tmux session åç¨± |
| `PAYDIRT_TUNNEL` | æŒä¹…ç‹€æ…‹/Context è·¯å¾‘ |
| `PAYDIRT_BIN` | CLI åŸ·è¡Œæª”è·¯å¾‘ |

### ç›®éŒ„çµæ§‹

```
.paydirt/
â”œâ”€â”€ prospects/           # Prospect è§’è‰²å®šç¾©
â”‚   â”œâ”€â”€ camp-boss.md
â”‚   â”œâ”€â”€ trail-boss.md
â”‚   â”œâ”€â”€ surveyor.md
â”‚   â”œâ”€â”€ shift-boss.md
â”‚   â”œâ”€â”€ miner.md
â”‚   â”œâ”€â”€ assayer.md
â”‚   â”œâ”€â”€ canary.md
â”‚   â”œâ”€â”€ smelter.md
â”‚   â”œâ”€â”€ claim-agent.md
â”‚   â””â”€â”€ scout.md
â”œâ”€â”€ tunnels/             # æŒä¹…ç‹€æ…‹å­˜å„²
â”œâ”€â”€ sources.yaml         # å¤–éƒ¨è³‡æºé…ç½®
â””â”€â”€ goldflow.yaml        # åŸ·è¡Œå¼•æ“é…ç½®
```

---

## 10. å»ºæ§‹ç­–ç•¥

### å»ºæ§‹åŸå‰‡

**ä¸ä¿®æ”¹ gastownï¼Œå…¨æ–°å»ºç«‹ paydirtï¼š**
- åœ¨ `gastown_b/paydirt/` ä¸‹å»ºç«‹å…¨æ–°å°ˆæ¡ˆ
- åƒè€ƒ legacy code ä½†ä¸ import/copy
- ä½¿ç”¨ bd è¿½è¹¤æ‰€æœ‰å»ºæ§‹ä»»å‹™
- ç¨ç«‹ repoï¼š`git@github.com:iamcxa/paydirt.git`

### ç›®éŒ„çµæ§‹

```
gastown_b/                    # ç¾æœ‰å°ˆæ¡ˆï¼ˆåƒè€ƒç”¨ï¼‰
â”œâ”€â”€ src/
â”œâ”€â”€ .gastown/
â”œâ”€â”€ gastown.ts
â””â”€â”€ paydirt/                  # ğŸ†• æ–°å°ˆæ¡ˆæ ¹ç›®éŒ„
    â”œâ”€â”€ .git/                 # ç¨ç«‹ git repo
    â”œâ”€â”€ .beads/               # bd è¿½è¹¤
    â”œâ”€â”€ .paydirt/
    â”‚   â””â”€â”€ prospects/        # è§’è‰²å®šç¾©
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ paydirt/          # Paydirt å±¤ï¼ˆCLIã€UXï¼‰
    â”‚   â””â”€â”€ goldflow/         # Goldflow å±¤ï¼ˆå¼•æ“ï¼‰
    â”œâ”€â”€ paydirt.ts            # ä¸»å…¥å£
    â”œâ”€â”€ deno.json
    â””â”€â”€ README.md
```

### Git è¨­å®š

```bash
cd gastown_b
mkdir paydirt && cd paydirt
git init
git remote add origin git@github.com:iamcxa/paydirt.git
bd init --prefix paydirt
```

### å»ºæ§‹éšæ®µ

**Phase 1ï¼šå°ˆæ¡ˆéª¨æ¶**
- åˆå§‹åŒ– Deno å°ˆæ¡ˆçµæ§‹
- è¨­å®š git repo å’Œ bd
- å»ºç«‹åŸºæœ¬ CLI æ¡†æ¶ï¼ˆ`pd`/`paydirt`ï¼‰

**Phase 2ï¼šPaydirt å±¤**
- å¯¦ä½œ Prospect è§’è‰²å®šç¾©
- å¯¦ä½œ Caravan ç®¡ç†
- å¯¦ä½œ Claim/Tunnel/Ledger æ¦‚å¿µ

**Phase 3ï¼šGoldflow å±¤**
- å¯¦ä½œ Sources/Stages/Processors
- å¯¦ä½œ Verifiers/Sinks
- å¯¦ä½œ Controllers/Metrics

**Phase 4ï¼šæ•´åˆ**
- é€£æ¥ Paydirt â†” Goldflow
- å¯¦ä½œ Dashboard (Boomtown)
- å®Œæ•´æ¸¬è©¦

---

## 11. è¦–è¦ºåŒ–è§’è‰²è¨­è¨ˆ

```
                    ğŸ‘‘ Chief Prospector (Human)
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼               â–¼               â–¼
         â›º Boomtown     ğŸ“œ Ledger      ğŸ—ºï¸ Claims
         (Dashboard)     (History)     (Projects)
              â”‚
              â–¼
         ğŸ–ï¸ Camp Boss â”€â”€â”€ "The operation runs smoothly."
              â”‚
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€ ğŸšƒ Caravan â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                          â”‚
    â”‚  ğŸ¤  Trail Boss           â”‚     "Let's move out!"
    â”‚     â”‚                    â”‚
    â”‚     â”œâ”€â”€ ğŸ“ Surveyor      â”‚     "I'll map the terrain."
    â”‚     â”œâ”€â”€ ğŸ‘· Shift Boss    â”‚     "Here's today's work."
    â”‚     â”‚                    â”‚
    â”‚     â””â”€â”€ Workers:         â”‚
    â”‚         â›ï¸ Miner         â”‚     "Digging deep."
    â”‚         ğŸ”¬ Assayer       â”‚     "Testing the ore."
    â”‚         ğŸ¤ Canary        â”‚     "All clear!"
    â”‚         ğŸ”¥ Smelter       â”‚     "Purifying gold."
    â”‚                          â”‚
    â”‚  ğŸ“‹ Claim Agent          â”‚     "The boss says..."
    â”‚  ğŸ”­ Scout                â”‚     "Found something!"
    â”‚                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Appendix: å®Œæ•´æ˜ å°„å°ç…§è¡¨

### Gas Town â†’ Paydirt è¡“èª

| Gas Town | Paydirt | é¡å‹ |
|----------|---------|------|
| Gas Town | Paydirt | ç”¢å“å |
| (engine) | Goldflow | å¼•æ“å |
| Convoy | Caravan | å·¥ä½œåœ˜éšŠ |
| Agent | Prospect | è§’è‰² |
| Dashboard | Boomtown | æ§åˆ¶ä¸­å¿ƒ |
| Context | Tunnel | æŒä¹…ç‹€æ…‹ |
| History | Ledger | æ­·å²è¨˜éŒ„ |
| Commander | Camp Boss | è§’è‰² |
| Mayor | Trail Boss | è§’è‰² |
| Planner | Surveyor | è§’è‰² |
| Foreman | Shift Boss | è§’è‰² |
| Polecat | Miner | è§’è‰² |
| Witness | Assayer | è§’è‰² |
| Dog | Canary | è§’è‰² |
| Refinery | Smelter | è§’è‰² |
| PM/Prime | Claim Agent | è§’è‰² |
| Linear-Scout | Scout | è§’è‰² |

### ç’°å¢ƒè®Šæ•¸æ˜ å°„

| Gas Town | Paydirt |
|----------|---------|
| `GASTOWN_BD` | `PAYDIRT_CLAIM` |
| `GASTOWN_CONVOY` | `PAYDIRT_CARAVAN` |
| `GASTOWN_ROLE` | `PAYDIRT_PROSPECT` |
| `GASTOWN_SESSION` | `PAYDIRT_SESSION` |
| `GASTOWN_CONTEXT` | `PAYDIRT_TUNNEL` |
| `GASTOWN_BIN` | `PAYDIRT_BIN` |

### CLI å‘½ä»¤æ˜ å°„

| Gas Town | Paydirt |
|----------|---------|
| `gastown start` | `paydirt stake` / `pd stake` |
| `gastown resume` | `paydirt continue` / `pd continue` |
| `gastown status` | `paydirt survey` / `pd survey` |
| `gastown stop` | `paydirt abandon` / `pd abandon` |
| `gastown spawn` | `paydirt prospect` / `pd prospect` |
| `gastown dashboard` | `paydirt boomtown` / `pd boomtown` |
